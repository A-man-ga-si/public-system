(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["profileAccount"],{"2c9f":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"profile"},[a("b-row",[a("b-col",{staticClass:"mx-auto",attrs:{md:6}},[a("div",{staticClass:"text-center"},[a("b-avatar",{staticClass:"border-0",attrs:{variant:"white",size:"8rem",src:e.profileImage}}),e._v(" "),a("a",{staticClass:"d-block mt-3 change-foto text-link text-primary",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.changePhoto.apply(null,arguments)}}},[e._v("\n          "+e._s(e.$t("pages.account.profile.change-photo"))+"\n        ")]),e._v(" "),a("input",{staticClass:"d-none",attrs:{type:"file",id:"profile-photo-input"}})],1),e._v(" "),a("div",{staticClass:"form-section mt-4"},[a("form",{staticClass:"profile-update-form",on:{submit:function(t){return t.preventDefault(),e.updateProfile.apply(null,arguments)}}},[a("ValidationInput",{staticClass:"mb-3",attrs:{"field-name":"first_name",label:e.$t("pages.account.profile.first-name")},model:{value:e.form.firstName,callback:function(t){e.$set(e.form,"firstName",t)},expression:"form.firstName"}}),e._v(" "),a("ValidationInput",{staticClass:"mb-3",attrs:{"field-name":"last_name",label:e.$t("pages.account.profile.last-name")},model:{value:e.form.lastName,callback:function(t){e.$set(e.form,"lastName",t)},expression:"form.lastName"}}),e._v(" "),a("ValidationInput",{staticClass:"mb-3",attrs:{"field-name":"phone",label:e.$t("pages.account.profile.phone")},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}}),e._v(" "),a("ValidationInput",{staticClass:"mb-3",attrs:{"field-name":"job",label:e.$t("pages.account.profile.job")},model:{value:e.form.job,callback:function(t){e.$set(e.form,"job",t)},expression:"form.job"}}),e._v(" "),a("b-btn",{staticClass:"mx-auto",class:{"show-spinner":e.processing,"btn-multiple-state btn-shadow":!0},attrs:{type:"submit",variant:"primary",disabled:e.processing}},[a("span",{staticClass:"spinner d-inline-block"},[a("span",{staticClass:"bounce1"}),e._v(" "),a("span",{staticClass:"bounce2"}),e._v(" "),a("span",{staticClass:"bounce3"})]),e._v(" "),a("span",{staticClass:"label"},[e._v("\n              "+e._s(e.$t("pages.account.profile.save-btn"))+"\n            ")])])],1)])])],1)],1)},r=[],s=a("1da1"),o=a("5530"),i=(a("99af"),a("96cf"),a("d5ad")),c=a("d452"),l=a("bd9a"),u=a("2f62"),f=a("2b47"),p={mixins:[i["a"]],data:function(){return{formDisabled:!0,processing:!1,form:{firstName:"",lastName:"",phone:"",job:""},errors:{first_name:"",last_name:"",phone:"",job:""},fileInput:null}},created:function(){this.fetchCurrentUserInfo()},mounted:function(){this.fileInput=document.querySelector("#profile-photo-input"),this.scanOnFileChangedListener()},methods:Object(o["a"])({fetchCurrentUserInfo:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r,s,o,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.fetchUserInfo(e.currentUser.id);case 3:a=t.sent,n=a.data,r=n.data.user,s=r.first_name,o=r.last_name,i=r.job,c=r.phone,e.form={job:i,phone:c,firstName:s,lastName:o},e.formDisabled=!1,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.error(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},changePhoto:function(){this.fileInput.click()},scanOnFileChangedListener:function(){var e=this;this.fileInput.addEventListener("change",(function(t){if(t.target.files){var a=new FormData;a.append("photo-update",t.target.files[0]),e.updateProfilePhoto(a)}}))},updateProfile:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.processing=!0,e.resetInvalid(),a=e.form,n=a.firstName,r=a.lastName,s=a.phone,o=a.job,t.next=6,e.updateUserInfo({userId:e.currentUser.id,data:{first_name:n,last_name:r,phone:s,job:o}});case 6:l["Notify"].success("Berhasil mengupdate profil"),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.checkForInvalidResponse(t.t0);case 12:return t.prev=12,e.processing=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},updateProfilePhoto:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t.processing=!0,a.next=4,t.updateUserPhoto({userId:t.currentUser.id,formData:e});case 4:l["Notify"].success("Berhasil mengupdate foto profil"),a.next=12;break;case 7:a.prev=7,a.t0=a["catch"](0),console.error(a.t0),422==(null===(n=a.t0.response)||void 0===n?void 0:n.status)&&l["Notify"].failure(a.t0.response.data.errors["photo-update"][0]),l["Notify"].failure("Gagal mengupdate foto profil");case 12:return a.prev=12,t.processing=!1,a.finish(12);case 15:case"end":return a.stop()}}),a,null,[[0,7,12,15]])})))()}},Object(u["b"])(["fetchUserInfo","updateUserInfo","updateUserPhoto"])),computed:Object(o["a"])(Object(o["a"])({},Object(u["c"])(["currentUser"])),{},{profileImage:function(){return this.currentUser?"".concat(f["b"],"/storage/uploads/users/profile-photo/").concat(this.currentUser.img):"#"}}),components:{ValidationInput:c["a"]}},d=p,m=(a("acf7"),a("2877")),v=Object(m["a"])(d,n,r,!1,null,"5e1d626e",null);t["default"]=v.exports},acf7:function(e,t,a){"use strict";a("f833")},d452:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"validation-input"},[a("label",{staticClass:"form-group has-float-label mb-0 can-invalid",class:e.fieldName},[a("input",{staticClass:"form-control",attrs:{type:e.type},domProps:{value:e.value},on:{input:function(t){return e.$emit("input",t.target.value)}}}),e._v(" "),a("span",[e._v(e._s(e.label))])]),e._v(" "),a("span",{staticClass:"mt-1 d-block text-danger error-msg d-none",attrs:{for:""}})])},r=[],s={props:{value:{type:String,required:!1},fieldName:{type:String,required:!0},label:{type:String,required:!0},type:{type:String,required:!1,default:"text"}}},o=s,i=a("2877"),c=Object(i["a"])(o,n,r,!1,null,null,null);t["a"]=c.exports},d5ad:function(e,t,a){"use strict";a("159b");var n=a("bd9a");t["a"]={methods:{setInvalid:function(e,t){var a=".can-invalid.".concat(e),n=document.querySelector("".concat(a," input.form-control")),r=document.querySelector("".concat(a," span")),s=document.querySelector("".concat(a," + .error-msg"));n.classList.add("border-danger"),r.classList.add("text-danger"),s.classList.remove("d-none"),s.innerHTML=t},processInvalid:function(e){for(var t in e.errors)this.setInvalid(t,e.errors[t])},resetInvalid:function(){var e=".can-invalid",t=document.querySelectorAll("".concat(e," input.form-control")),a=document.querySelectorAll("".concat(e," span")),n=document.querySelectorAll("".concat(e," + .error-msg"));t.forEach((function(e){e.classList.remove("border-danger")})),a.forEach((function(e){e.classList.remove("text-danger")})),n.forEach((function(e){e.classList.add("d-none"),e.innerHTML=""}))},checkForInvalidResponse:function(e){var t;switch(null===(t=e.response)||void 0===t?void 0:t.status){case 422:this.processInvalid(e.response.data);break;default:n["Notify"].failure("Terjadi kesalahan"),console.error(e);break}}}}},f833:function(e,t,a){}}]);